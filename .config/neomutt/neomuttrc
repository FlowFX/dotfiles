set mbox_type   = Maildir
set sendmail    = msmtp

set header_cache = "~/.cache/muttheaders"

# MACROS and BINDINGS -------------------------
# Reload configuration file
macro index,pager ,r ":source $XDG_CONFIG_HOME/neomutt/neomuttrc<enter>"

# Sync email
macro index O "<shell-escape>offlineimap -u blinkenlights\r"      "run offlineimap to sync all mail"
macro index ,o "<shell-escape>offlineimap -u basic -q -f INBOX\r" "run offlineimap quick and quiet"

# Don't just delete. REALLY delete!
bind index D purge-message

# HOOKS --------------------------------------
# Sync mailbox on exit. All other mailboxes are synced whenever I change mailboxes or directories.
shutdown-hook 'exec sync-mailbox'

# Edit settings
set edit_headers = yes               # Put headers in editor when composing
set editor = "nvim +7 %s"            # Open Vim and move to line 7
set fast_reply = yes                 # Don't ask for Subject/recipient when replying, or Subject when forwarding
set forward_edit = yes               # Always allow to edit before forwarding
set forward_format = "Fwd: %s"       # Jesus, mutt
set include = yes                    # include body
set reflow_text = yes                # All hail format=flowed
set reflow_wrap = 78                 # If GOD would have wanted a larger number, SHE'd have given us larger screens
set wrap = 120                       # Wrap incoming text at 120 chars

# Contacts ----------------------------------------
set query_command= "khard email --parsable '%s'"      # Tab completion for address book
bind editor <Tab> complete-query
bind editor ^T    complete

macro index,pager ,a \
    "<pipe-message>khard add-email<return>" \
    "add the sender email address to khard"

# The Pager
set pager_index_lines = 10
set pager_context = 3
set pager_stop = yes # Do not progress to next mail

# The Index
set sort =threads # Threads!

# Other configs
source $XDG_CONFIG_HOME/neomutt/mutt.d/colors
source $XDG_CONFIG_HOME/neomutt/mutt.d/sidebar

# Behavior
set delete = yes            # Just do it!
set auto_tag = yes          # Apply actions to all tagged mails, regardless of <tag-prefix>
set beep = no
set beep_new = no
set confirmappend = no      # Do not ask before deleting/moving to existing mailbox
set confirmcreate = yes     # But do ask before creating a mailbox

source $XDG_CONFIG_HOME/neomutt/neomuttrc.local.$LOCAL_CONFIG
